<!doctype html>
<html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>Fourier Transform - Ferg Blog</title><link rel="manifest" href="/manifest.json"><meta name="theme-color" content="green"><meta name="application-name" content="Ferg Blog"><meta name="msapplication-TileColor" content="green"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="Ferg Blog"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta name="description" content="123import cvxpyimport matplotlib.pyplot as pltimport librosa  Begin by loading the wave form and plotting 123456789audio_path &amp;#x3D; &amp;quot;speech.wav&amp;quot;waveform, sample_rate &amp;#x3D; librosa.load(audio_path, s"><meta property="og:type" content="blog"><meta property="og:title" content="Fourier Transform"><meta property="og:url" content="https://ferguscurrie.github.io/2023/05/15/fourier_transform/"><meta property="og:site_name" content="Ferg Blog"><meta property="og:description" content="123import cvxpyimport matplotlib.pyplot as pltimport librosa  Begin by loading the wave form and plotting 123456789audio_path &amp;#x3D; &amp;quot;speech.wav&amp;quot;waveform, sample_rate &amp;#x3D; librosa.load(audio_path, s"><meta property="og:locale" content="en_US"><meta property="og:image" content="https://ferguscurrie.github.io/images/output_3_0.png"><meta property="og:image" content="https://ferguscurrie.github.io/images/output_5_0.png"><meta property="og:image" content="https://ferguscurrie.github.io/images/output_7_0.png"><meta property="og:image" content="https://ferguscurrie.github.io/images/output_9_0.png"><meta property="og:image" content="https://ferguscurrie.github.io/images/output_11_0.png"><meta property="og:image" content="https://ferguscurrie.github.io/images/output_13_0.png"><meta property="og:image" content="https://ferguscurrie.github.io/images/output_16_0.png"><meta property="og:image" content="https://ferguscurrie.github.io/images/output_18_0.png"><meta property="og:image" content="https://ferguscurrie.github.io/images/output_22_1.png"><meta property="og:image" content="https://ferguscurrie.github.io/images/output_29_1.png"><meta property="og:image" content="https://ferguscurrie.github.io/images/euler.gif"><meta property="og:image" content="https://ferguscurrie.github.io/images/windowed_signal.png"><meta property="og:image" content="https://ferguscurrie.github.io/images/spec.png"><meta property="article:published_time" content="2023-05-14T23:00:00.000Z"><meta property="article:modified_time" content="2023-06-14T01:29:27.583Z"><meta property="article:author" content="Fergus Currie"><meta property="article:tag" content="signal-processing"><meta property="twitter:card" content="summary"><meta property="twitter:image:src" content="https://ferguscurrie.github.io/images/output_3_0.png"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://ferguscurrie.github.io/2023/05/15/fourier_transform/"},"headline":"Fourier Transform","image":["https://ferguscurrie.github.io/images/output_3_0.png","https://ferguscurrie.github.io/images/output_5_0.png","https://ferguscurrie.github.io/images/output_7_0.png","https://ferguscurrie.github.io/images/output_9_0.png","https://ferguscurrie.github.io/images/output_11_0.png","https://ferguscurrie.github.io/images/output_13_0.png","https://ferguscurrie.github.io/images/output_16_0.png","https://ferguscurrie.github.io/images/output_18_0.png","https://ferguscurrie.github.io/images/output_22_1.png","https://ferguscurrie.github.io/images/output_29_1.png","https://ferguscurrie.github.io/images/euler.gif","https://ferguscurrie.github.io/images/windowed_signal.png","https://ferguscurrie.github.io/images/spec.png"],"datePublished":"2023-05-14T23:00:00.000Z","dateModified":"2023-06-14T01:29:27.583Z","author":{"@type":"Person","name":"Fergus Currie"},"publisher":{"@type":"Organization","name":"Ferg Blog","logo":{"@type":"ImageObject","url":"https://ferguscurrie.github.io/img/logo.svg"}},"description":"123import cvxpyimport matplotlib.pyplot as pltimport librosa  Begin by loading the wave form and plotting 123456789audio_path &#x3D; &quot;speech.wav&quot;waveform, sample_rate &#x3D; librosa.load(audio_path, s"}</script><link rel="canonical" href="https://ferguscurrie.github.io/2023/05/15/fourier_transform/"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v6.0.0/css/all.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-light.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><!--!--><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/css/justifiedGallery.min.css"><!--!--><!--!--><!--!--><style>.pace{-webkit-pointer-events:none;pointer-events:none;-webkit-user-select:none;-moz-user-select:none;user-select:none}.pace-inactive{display:none}.pace .pace-progress{background:#3273dc;position:fixed;z-index:2000;top:0;right:100%;width:100%;height:2px}</style><script src="https://cdn.jsdelivr.net/npm/pace-js@1.2.4/pace.min.js"></script><!--!--><!--!--><!-- hexo injector head_end start --><script>
  (function () {
      function switchTab() {
          if (!location.hash) {
            return;
          }

          const id = '#' + CSS.escape(location.hash.substring(1));
          const $tabMenu = document.querySelector(`.tabs a[href="${id}"]`);
          if (!$tabMenu) {
            return;
          }

          const $tabMenuContainer = $tabMenu.parentElement.parentElement;
          Array.from($tabMenuContainer.children).forEach($menu => $menu.classList.remove('is-active'));
          Array.from($tabMenuContainer.querySelectorAll('a'))
              .map($menu => document.getElementById($menu.getAttribute("href").substring(1)))
              .forEach($content => $content.classList.add('is-hidden'));

          if ($tabMenu) {
              $tabMenu.parentElement.classList.add('is-active');
          }
          const $activeTab = document.querySelector(id);
          if ($activeTab) {
              $activeTab.classList.remove('is-hidden');
          }
      }
      switchTab();
      window.addEventListener('hashchange', switchTab, false);
  })();
  </script><!-- hexo injector head_end end --><meta name="generator" content="Hexo 6.3.0"></head><body class="is-3-column"><nav class="navbar navbar-main"><div class="container navbar-container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="/img/logo.svg" alt="Ferg Blog" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">Home</a><a class="navbar-item" href="/About">About</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/FergusCurrie"><i class="fab fa-github"></i></a><a class="navbar-item" target="_blank" rel="noopener" title="Linkedin" href="https://www.linkedin.com/in/fergus-currie-167233193/"><i class="fab fa-linkedin"></i></a><a class="navbar-item search" title="Search" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-6-widescreen"><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2023-05-14T23:00:00.000Z" title="15/05/2023, 11:00:00 am">2023-05-15</time></span><span class="level-item">Updated&nbsp;<time dateTime="2023-06-14T01:29:27.583Z" title="14/06/2023, 1:29:27 pm">2023-06-14</time></span><span class="level-item">13 minutes read (About 1885 words)</span></div></div><h1 class="title is-3 is-size-4-mobile">Fourier Transform</h1><div class="content"><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> cvxpy</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> librosa</span><br></pre></td></tr></table></figure>

<p>Begin by loading the wave form and plotting</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">audio_path = <span class="string">&quot;speech.wav&quot;</span></span><br><span class="line">waveform, sample_rate = librosa.load(audio_path, sr=<span class="literal">None</span>)  <span class="comment"># sr=None preserves sample rate</span></span><br><span class="line"></span><br><span class="line">plt.figure(figsize=(<span class="number">14</span>, <span class="number">5</span>))</span><br><span class="line">plt.plot(waveform)</span><br><span class="line">plt.title(<span class="string">f&quot;Waveform. sample rate=<span class="subst">&#123;sample_rate&#125;</span>Hz&quot;</span>)</span><br><span class="line">plt.xlabel(<span class="string">&quot;Samples&quot;</span>)</span><br><span class="line">plt.ylabel(<span class="string">&quot;Amplitude&quot;</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>

<p><img src="/images/output_3_0.png" alt="png"></p>
<p>Now lets look at what’s going on zoomed in</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">s</span>(<span class="params">t</span>):</span><br><span class="line">    <span class="keyword">return</span> waveform[<span class="number">1000</span>:<span class="number">2000</span>][t]</span><br><span class="line"></span><br><span class="line">t = np.arange(<span class="number">1000</span>)</span><br><span class="line">plt.figure(figsize=(<span class="number">14</span>, <span class="number">5</span>))</span><br><span class="line">plt.plot(s(t))</span><br><span class="line">plt.title(<span class="string">f&quot;Waveform. sample rate=<span class="subst">&#123;sample_rate&#125;</span>Hz&quot;</span>)</span><br><span class="line">plt.xlabel(<span class="string">&quot;Samples&quot;</span>)</span><br><span class="line">plt.ylabel(<span class="string">&quot;Amplitude&quot;</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>

<p><img src="/images/output_5_0.png" alt="png"></p>
<p>Okay now a brief review of sinusoids</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sinusoid</span>(<span class="params">t,freq,phase</span>):</span><br><span class="line">    <span class="keyword">return</span> np.sin(<span class="number">2</span> * np.pi * (freq * t - phase))</span><br><span class="line"></span><br><span class="line">t = np.linspace(<span class="number">0</span>,<span class="number">10</span>,<span class="number">1000</span>)</span><br><span class="line"></span><br><span class="line">plt.figure(figsize=(<span class="number">14</span>, <span class="number">5</span>))</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>):</span><br><span class="line">    y = sinusoid(t, <span class="number">1</span>, i*<span class="number">0.1</span>)</span><br><span class="line">    plt.plot(t, y, label=<span class="string">f&#x27;phase=<span class="subst">&#123;i*<span class="number">0.1</span>&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line">plt.title(<span class="string">f&quot;Sinusoid phase example&quot;</span>)</span><br><span class="line">plt.xlabel(<span class="string">&quot;Samples&quot;</span>)</span><br><span class="line">plt.ylabel(<span class="string">&quot;Amplitude&quot;</span>)</span><br><span class="line">plt.legend()</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>

<p><img src="/images/output_7_0.png" alt="png"></p>
<p>The phase is a horizontal shift of the sin wave.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sinusoid</span>(<span class="params">t,freq,phase</span>):</span><br><span class="line">    <span class="keyword">return</span> np.sin(<span class="number">2</span> * np.pi * (freq * t - phase))</span><br><span class="line"></span><br><span class="line">t = np.linspace(<span class="number">0</span>,<span class="number">10</span>,<span class="number">1000</span>)</span><br><span class="line"></span><br><span class="line">plt.figure(figsize=(<span class="number">14</span>, <span class="number">5</span>))</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">4</span>):</span><br><span class="line">    y = sinusoid(t, <span class="number">0.5</span>*i, <span class="number">1</span>)</span><br><span class="line">    plt.plot(t, y, label=<span class="string">f&#x27;freq=<span class="subst">&#123;i*<span class="number">0.5</span>&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line">plt.title(<span class="string">f&quot;Sinusoid frequency example&quot;</span>)</span><br><span class="line">plt.xlabel(<span class="string">&quot;Samples&quot;</span>)</span><br><span class="line">plt.ylabel(<span class="string">&quot;Amplitude&quot;</span>)</span><br><span class="line">plt.legend()</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>

<p><img src="/images/output_9_0.png" alt="png"></p>
<p>The fourier transform converts from the time domain to the frequency domain. It does this by representing the signal as infinitely many sinusoids of varying frequency. The main steps are:</p>
<ol>
<li>Enumerate accross frequency</li>
<li>For each frequency optimise phase to maximise similarity of sinusoid with signal</li>
<li>Calculate magnitude as similarity.</li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">freq = <span class="number">0.013</span></span><br><span class="line">phase = <span class="number">1</span></span><br><span class="line"></span><br><span class="line">plt.figure(figsize=(<span class="number">14</span>, <span class="number">5</span>))</span><br><span class="line">t = np.arange(<span class="number">1000</span>)</span><br><span class="line">y = sinusoid(t, freq, phase) * <span class="number">.1</span></span><br><span class="line">plt.plot(s(t), label=<span class="string">&#x27;origianl signal&#x27;</span>)</span><br><span class="line">plt.plot(t, y, label=<span class="string">f&#x27;sinusoid&#x27;</span>)</span><br><span class="line">plt.title(<span class="string">f&quot;Maximising similarity for freq=<span class="subst">&#123;freq&#125;</span> sinusoid by shifting phase=<span class="subst">&#123;phase&#125;</span>&quot;</span>)</span><br><span class="line">plt.xlabel(<span class="string">&quot;Samples&quot;</span>)</span><br><span class="line">plt.ylabel(<span class="string">&quot;Amplitude&quot;</span>)</span><br><span class="line">plt.legend()</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>

<p><img src="/images/output_11_0.png" alt="png"></p>
<p>They’re completly out of phase here. But we can tweak the phase to try have peaks matching.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">freq = <span class="number">0.013</span></span><br><span class="line">phase = <span class="number">0.5</span></span><br><span class="line"></span><br><span class="line">plt.figure(figsize=(<span class="number">14</span>, <span class="number">5</span>))</span><br><span class="line">t = np.arange(<span class="number">1000</span>)</span><br><span class="line">y = sinusoid(t, freq, phase) * <span class="number">.1</span></span><br><span class="line">plt.plot(s(t), label=<span class="string">&#x27;origianl signal&#x27;</span>)</span><br><span class="line">plt.plot(t, y, label=<span class="string">f&#x27;sinusoid&#x27;</span>)</span><br><span class="line">plt.title(<span class="string">f&quot;Maximising similarity for freq=<span class="subst">&#123;freq&#125;</span> sinusoid by shifting phase=<span class="subst">&#123;phase&#125;</span>&quot;</span>)</span><br><span class="line">plt.xlabel(<span class="string">&quot;Samples&quot;</span>)</span><br><span class="line">plt.ylabel(<span class="string">&quot;Amplitude&quot;</span>)</span><br><span class="line">plt.legend()</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>

<p><img src="/images/output_13_0.png" alt="png"></p>
<p>That’s a bit better. To measure the similarity between the signal and the sinusoid specified by frequency and phase we use an inner product.</p>
<p>$$ \phi_f &#x3D; argmax_{\phi \in [0,1]} \left[ \int s(t) \sin(2 \pi (ft - \phi)) dt\right] $$</p>
<p>So the similarity is the area of the product of the original signal and the sinusoid. Intuitievly if they’re out of phase they cancel each other and the area is minimised.</p>
<p>The magnitude (similarity) is then:<br>$$ \phi_f &#x3D; max_{\phi \in [0,1]} \left[ \int s(t) \sin(2 \pi (ft - \phi)) dt \right] $$</p>
<p>Looking at the out of phase product:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">freq = <span class="number">0.013</span></span><br><span class="line">phase = <span class="number">1</span></span><br><span class="line"></span><br><span class="line">plt.figure(figsize=(<span class="number">14</span>, <span class="number">5</span>))</span><br><span class="line">t = np.arange(<span class="number">1000</span>)</span><br><span class="line">y = sinusoid(t, freq, phase) * <span class="number">.1</span></span><br><span class="line">plt.plot(t, s(t) * y, label=<span class="string">f&#x27;product&#x27;</span>)</span><br><span class="line">plt.plot(np.zeros(<span class="number">1000</span>))</span><br><span class="line">plt.title(<span class="string">f&quot;Out of phase Product between signal and sinusoid for freq=<span class="subst">&#123;freq&#125;</span>  by shifting phase=<span class="subst">&#123;phase&#125;</span>&quot;</span>)</span><br><span class="line">plt.xlabel(<span class="string">&quot;Samples&quot;</span>)</span><br><span class="line">plt.ylabel(<span class="string">&quot;Amplitude&quot;</span>)</span><br><span class="line">plt.legend()</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>

<p><img src="/images/output_16_0.png" alt="png"></p>
<p>Notice it’s mostly negative</p>
<p>And now looking at the inphase product:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">freq = <span class="number">0.013</span></span><br><span class="line">phase = <span class="number">0.5</span></span><br><span class="line"></span><br><span class="line">plt.figure(figsize=(<span class="number">14</span>, <span class="number">5</span>))</span><br><span class="line">t = np.arange(<span class="number">1000</span>)</span><br><span class="line">y = sinusoid(t, freq, phase) * <span class="number">.1</span></span><br><span class="line">plt.plot(t, s(t) * y, label=<span class="string">f&#x27;product&#x27;</span>)</span><br><span class="line">plt.plot(np.zeros(<span class="number">1000</span>))</span><br><span class="line">plt.title(<span class="string">f&quot;Product between signal and sinusoid for freq=<span class="subst">&#123;freq&#125;</span>  by shifting phase=<span class="subst">&#123;phase&#125;</span>&quot;</span>)</span><br><span class="line">plt.xlabel(<span class="string">&quot;Samples&quot;</span>)</span><br><span class="line">plt.ylabel(<span class="string">&quot;Amplitude&quot;</span>)</span><br><span class="line">plt.legend()</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>

<p><img src="/images/output_18_0.png" alt="png"></p>
<p>Mostly positive. This in-phase product will have a much higher area, which will be calculated with the integral.</p>
<p>So a simple fourier transform would iterative over a bunch of frequencies, for each find phase that maximises inner product with signal, and record the magnitude (area&#x2F;similarity). Will do that now:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">num_phases = <span class="number">10</span></span><br><span class="line">num_freqs = <span class="number">1000</span></span><br><span class="line"></span><br><span class="line">freq_max_magnitudes = np.zeros(num_freqs)</span><br><span class="line"><span class="keyword">for</span> freq_i, freq <span class="keyword">in</span> <span class="built_in">enumerate</span>(np.linspace(<span class="number">0</span>, <span class="number">0.1</span>, num_freqs)):</span><br><span class="line">    phase_magnitudes = np.zeros(num_phases)</span><br><span class="line">    <span class="keyword">for</span> phase_i, phase <span class="keyword">in</span> <span class="built_in">enumerate</span>(np.linspace(<span class="number">0</span>, <span class="number">1</span>, num_phases)):</span><br><span class="line">        magnitude = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> t <span class="keyword">in</span> np.arange(<span class="number">1000</span>):</span><br><span class="line">            prod = s(t) * np.sin(np.pi * <span class="number">2</span> * (freq * t - phase))</span><br><span class="line">            magnitude += prod</span><br><span class="line">        phase_magnitudes[phase_i] = magnitude</span><br><span class="line">    freq_max_magnitudes[freq_i] = np.<span class="built_in">max</span>(phase_magnitudes)</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">plt.figure(figsize=(<span class="number">14</span>, <span class="number">5</span>))</span><br><span class="line">f = np.linspace(<span class="number">0</span>, <span class="number">0.1</span>, num_freqs)</span><br><span class="line">plt.plot(f, freq_max_magnitudes)</span><br><span class="line">plt.title(<span class="string">f&quot;Spectrograph&quot;</span>)</span><br><span class="line">plt.xlabel(<span class="string">&quot;Frequency&quot;</span>)</span><br><span class="line">plt.ylabel(<span class="string">&quot;Magnitude&quot;</span>)</span><br><span class="line">plt.legend()</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>

<p><img src="/images/output_22_1.png" alt="png"></p>
<p>This concludes the first section on the basics of the fourier transform. I will now move on to representing this in a cleaner way, using complex numbers.</p>
<h1 id="Complex-Number-Fourier-Transform"><a href="#Complex-Number-Fourier-Transform" class="headerlink" title="Complex Number Fourier Transform"></a>Complex Number Fourier Transform</h1><p>The key idea is encoding the magnitude and phase as a complex number. The magnitude is the length of the complex number, and the phase is the angle. “The complex fourier transform coefficient”.</p>
<p>$$\hat{g}(f) &#x3D; c_f &#x3D; \dfrac{d_f}{\sqrt{2}} e^{-i2\pi \phi f}$$</p>
<p>$$\hat{g}(f) &#x3D; $\int g(t) e^{-i 2 \pi f t}dt$<br>Where $c_f$ is the complex fourier transform coefficient.</p>
<p>THe fourier transform is the gunction $\hat{g} : R \rightarrow C$, a function mapping forom real numbers (frequency) to complex numbers (complex fourier transform coefficient).</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"><span class="keyword">import</span> imageio</span><br><span class="line"><span class="keyword">from</span> IPython.display <span class="keyword">import</span> Image, display</span><br><span class="line"></span><br><span class="line"><span class="comment"># Generate your matplotlib plots</span></span><br><span class="line"><span class="comment"># Replace the code below with your own plot generation logic</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>First a remineder on complex numbers .</p>
<p>$ i &#x3D; \sqrt{ -1 }$</p>
<p>Usually expressed with real and complext part</p>
<p>z &#x3D; 3 + 2j</p>
<!-- ```python
# Complex number
z = 0 + 2j

# Extract real and imaginary parts
x = z.real
y = z.imag

# Create a scatter plot
plt.scatter(x, y, color='red')
plt.xlabel('Real')
plt.ylabel('Imaginary')
plt.title('Complex Number')

# Show the plot
plt.show()
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">![png](/images/output_27_0.png) --&gt;</span><br><span class="line"></span><br><span class="line">Next lets look at the euler formula</span><br><span class="line"></span><br><span class="line">```python</span><br><span class="line">theta = np.linspace(0, 2*np.pi, 50)</span><br><span class="line">euler_form = np.exp(z * theta)</span><br><span class="line"></span><br><span class="line">x = euler_form.real</span><br><span class="line">y = euler_form.imag</span><br><span class="line"></span><br><span class="line"># Create a scatter plot</span><br><span class="line">plt.scatter(x, y, color=&#x27;red&#x27;)</span><br><span class="line">plt.xlabel(&#x27;Real&#x27;)</span><br><span class="line">plt.ylabel(&#x27;Imaginary&#x27;)</span><br><span class="line">plt.title(&#x27;Complex Number&#x27;)</span><br></pre></td></tr></table></figure>

<p><img src="/images/output_29_1.png" alt="png"></p>
<p>We can see it traces the unit sphere. It might be helpful to look at a GIF of this in action</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line">num_frames = <span class="number">40</span></span><br><span class="line">frames = []</span><br><span class="line"><span class="keyword">if</span> os.path.exists(<span class="string">&#x27;frames&#x27;</span>):</span><br><span class="line">    os.system(<span class="string">&#x27;rm -rf frames&#x27;</span>)</span><br><span class="line">os.mkdir(<span class="string">&#x27;frames&#x27;</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(num_frames):</span><br><span class="line">    theta_ = theta[:i]</span><br><span class="line">    euler_form = np.exp(z * theta_)</span><br><span class="line"></span><br><span class="line">    x = euler_form.real</span><br><span class="line">    y = euler_form.imag</span><br><span class="line"></span><br><span class="line">    plt.plot(x, y)</span><br><span class="line">    plt.title(<span class="string">f&quot;Frame <span class="subst">&#123;i+<span class="number">1</span>&#125;</span>&quot;</span>)</span><br><span class="line">    plt.xlabel(<span class="string">&quot;Real&quot;</span>)</span><br><span class="line">    plt.ylabel(<span class="string">&quot;Imaginary&quot;</span>)</span><br><span class="line">    plt.xlim(-<span class="number">1.1</span>, <span class="number">1.1</span>)</span><br><span class="line">    plt.ylim(-<span class="number">1.1</span>, <span class="number">1.1</span>)</span><br><span class="line">    plt.gca().set_aspect(<span class="string">&#x27;equal&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Save the current plot as an image</span></span><br><span class="line">    plt.savefig(<span class="string">f&quot;frames/frame_<span class="subst">&#123;i&#125;</span>.png&quot;</span>)</span><br><span class="line">    plt.close()  <span class="comment"># Close the figure to avoid memory leaks</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># Read the saved image and append it to the frames list</span></span><br><span class="line">    frames.append(imageio.imread(<span class="string">f&quot;frames/frame_<span class="subst">&#123;i&#125;</span>.png&quot;</span>))</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> os.path.exists(<span class="string">&#x27;frames&#x27;</span>):</span><br><span class="line">    os.system(<span class="string">&#x27;rm -rf frames&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Save the frames as a GIF</span></span><br><span class="line">imageio.mimsave(<span class="string">&quot;euler.gif&quot;</span>, frames, duration=<span class="number">0.1</span>)</span><br></pre></td></tr></table></figure>

<p><img src="/images/euler.gif"></p>
<p>This shows how the euler formula traces the unit sphere on the complex plane counter clockwise. This gives an easy way of representing the polar coordinates of a complex number c:</p>
<p>$$ c &#x3D; |c|\exp{(i \theta)} $$</p>
<p>where $\exp{(i \theta)}$ gives a direction and the absolute length of c gives the distance to the complex number c.</p>
<p>The point of all this complex stuff is to use the magnitude and phase as polar coordinates. Phase gives the roation while magnitude gives the distance.</p>
<p>We can then write the fourier coefficient as :</p>
<p>$$ c_f &#x3D; \dfrac{d_f}{\sqrt 2 } \exp(-i2 \pi\theta f)$$</p>
<p>The minus sign in the exponent switches to tracking clockwise.</p>
<p>The fourier transform can then be expressed….</p>
<h1 id="Inverse-Fourier-Transform"><a href="#Inverse-Fourier-Transform" class="headerlink" title="Inverse Fourier Transform"></a>Inverse Fourier Transform</h1><p>The inverse fourier transform is the function $\hat{g}^{-1} : C \rightarrow R$, a function mapping from complex numbers (complex fourier transform coefficient) to real numbers (frequency). It just means we can take the fourier transform and get back the original signal.</p>
<h1 id="Discrete-Fourier-Transform"><a href="#Discrete-Fourier-Transform" class="headerlink" title="Discrete Fourier Transform"></a>Discrete Fourier Transform</h1><p>The previous definitions have been for continuous functions. In practice everything is discrete. In the DFT the continuous signal $s(t)$ is replaced with a sequence of $n$ signal samples $x(n)$.</p>
<p>$$\hat{g}(\dfrac{k}{N}) &#x3D; $\sum_n x(n) e^{-i 2 \pi \dfrac{k}{N} n}$$</p>
<p>Notice that the frequency must still be made discrete. Once again we sample and only calculate transforms for finite number (M) of frequencies. Generally set M (number frequencies) &#x3D; N (number signal samples) &#x2F; 2. This is the nyquist frequency. Frequency &#x3D; $\dfrac{k}{N}$.</p>
<p>DFT is $O(N^2)$, can use the FFT to make it $O(N \log_2 N)$. It exploits redundency accross sinusoids. The FFT is just an algorithm for computing the DFT.</p>
<h1 id="Short-Time-Fourier-Transform"><a href="#Short-Time-Fourier-Transform" class="headerlink" title="Short Time Fourier Transform"></a>Short Time Fourier Transform</h1><p>The fourier transform extracts frequency components from a possibly non-periodic signal. This gives us the ‘what’ of the signal but not the ‘where’. The STFT gives us the ‘where’ of the signal. It is a fourier transform applied to a windowed signal. The window is a function that is 1 for a certain time and 0 everywhere else. The window is then slid across the signal and the fourier transform is applied to each window. This gives us the frequency components of the signal at each time step.<br>A window function looks like this:</p>
<p>$$<br>x_w(k) &#x3D; x(k)w(k)<br>$$</p>
<p>where $x(k)$ is the signal and $w(k)$ is the window function. The window function is 1 for a certain time and 0 everywhere else.</p>
<p>Window size &#x3D; length of window in # samples<br>Frame size &#x3D; number of samples in window in # samples<br>Hop size &#x3D; number of samples to slide to right</p>
<p>Frame size can be larger sometimes. Generally they are equal.</p>
<p>Example of windowed signal.<br><img src="/images/windowed_signal.png"></p>
<h2 id="From-DFT-to-STFT"><a href="#From-DFT-to-STFT" class="headerlink" title="From DFT to STFT"></a>From DFT to STFT</h2><p>$$ S(m,k) &#x3D; $\sum_n x(n +mH)w(n) e^{-i 2 \pi \dfrac{k}{N} n}$$</p>
<p>where $w(n)$ is the window function, $m$ is the mth window&#x2F;frame number, $k$ is the frequency, $H$ is the hop size, $N$ is the frame size.<br>The DFToutputs a spectral vector with a bin for each frequncy (N complex fourier coefficients). The STFT outputs a spectral matrix (# freqeuncy bins, # num frames). The STFT is a time-frequency representation of the signal.</p>
<p>Finally calculating the STFT in python:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">librosa stft</span></span><br><span class="line"><span class="string">n_fft = length of the windowed signal</span></span><br><span class="line"><span class="string">hop_length = samples to move for each dft. win_length // 4 default</span></span><br><span class="line"><span class="string">win_length = Each frame of audio is windowed by window of length win_length and then padded with zeros to match n_fft</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line">S = librosa.stft(s(t),  n_fft=<span class="number">100</span>)</span><br><span class="line">spectrogram = np.absolute(S) ** <span class="number">2</span></span><br><span class="line">plt.imshow(spectrogram)</span><br></pre></td></tr></table></figure>

<p><img src="/images/spec.png"></p>
<p>This looks a little odd due to the size of the signal. Notice the conversion from complex to real.<br>The spectrogram is fundemental to audio deep learning which is why I have gone through this post to get a deep understanding for the data.</p>
</div><div class="article-licensing box"><div class="licensing-title"><p>Fourier Transform</p><p><a href="https://ferguscurrie.github.io/2023/05/15/fourier_transform/">https://ferguscurrie.github.io/2023/05/15/fourier_transform/</a></p></div><div class="licensing-meta level is-mobile"><div class="level-left"><div class="level-item is-narrow"><div><h6>Author</h6><p>Fergus Currie</p></div></div><div class="level-item is-narrow"><div><h6>Posted on</h6><p>2023-05-15</p></div></div><div class="level-item is-narrow"><div><h6>Updated on</h6><p>2023-06-14</p></div></div><div class="level-item is-narrow"><div><h6>Licensed under</h6><p><a class="icons" rel="noopener" target="_blank" title="Creative Commons" href="https://creativecommons.org/"><i class="icon fab fa-creative-commons"></i></a><a class="icons" rel="noopener" target="_blank" title="Attribution" href="https://creativecommons.org/licenses/by/4.0/"><i class="icon fab fa-creative-commons-by"></i></a><a class="icons" rel="noopener" target="_blank" title="Noncommercial" href="https://creativecommons.org/licenses/by-nc/4.0/"><i class="icon fab fa-creative-commons-nc"></i></a></p></div></div></div></div></div><div class="article-tags is-size-7 mb-4"><span class="mr-2">#</span><a class="link-muted mr-2" rel="tag" href="/tags/signal-processing/">signal-processing</a></div><!--!--></article></div><!--!--><nav class="post-navigation mt-4 level is-mobile"><div class="level-start"><a class="article-nav-prev level level-item link-muted" href="/2023/06/02/llm_tricks/"><i class="level-item fas fa-chevron-left"></i><span class="level-item">LLM Tricks</span></a></div><div class="level-end"><a class="article-nav-next level level-item link-muted" href="/2023/05/02/deep_cluster/"><span class="level-item">Deep Cluster</span><i class="level-item fas fa-chevron-right"></i></a></div></nav><!--!--></div><div class="column column-left is-4-tablet is-4-desktop is-3-widescreen  order-1"><div class="card widget" data-type="profile"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar" src="/img/avatar.png" alt="Fergus Currie"></figure><p class="title is-size-4 is-block" style="line-height:inherit;">Fergus Currie</p><p class="is-size-6 is-block">Machine Learning Engineer</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>Melbourne</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">Posts</p><a href="/archives"><p class="title">5</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Categories</p><a href="/categories"><p class="title">0</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Tags</p><a href="/tags"><p class="title">7</p></a></div></div></nav><div class="level"><a class="level-item button is-primary is-rounded" href="https://github.com/ppoffice" target="_blank" rel="noopener">Follow</a></div><div class="level is-mobile is-multiline"><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Github" href="https://github.com/FergusCurrie"><i class="fab fa-github"></i></a></div></div></div><!--!--><!--!--><div class="card widget" data-type="recent-posts"><div class="card-content"><h3 class="menu-label">Recents</h3><article class="media"><div class="media-content"><p class="date"><time dateTime="2023-06-02T04:02:21.000Z">2023-06-02</time></p><p class="title"><a href="/2023/06/02/llm_tricks/">LLM Tricks</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2023-05-14T23:00:00.000Z">2023-05-15</time></p><p class="title"><a href="/2023/05/15/fourier_transform/">Fourier Transform</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2023-05-02T02:02:21.000Z">2023-05-02</time></p><p class="title"><a href="/2023/05/02/deep_cluster/">Deep Cluster</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2023-04-02T04:02:21.000Z">2023-04-02</time></p><p class="title"><a href="/2023/04/02/cuttingplane/">Cutting Plane Algorithms</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2023-03-29T03:02:21.000Z">2023-03-29</time></p><p class="title"><a href="/2023/03/29/advanced_tf/">Coursera - TensorFlow Advanced Techniques Specialisation</a></p></div></article></div></div><div class="card widget" data-type="archives"><div class="card-content"><div class="menu"><h3 class="menu-label">Archives</h3><ul class="menu-list"><li><a class="level is-mobile" href="/archives/2023/"><span class="level-start"><span class="level-item">2023</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li></ul></div></div></div><div class="card widget" data-type="tags"><div class="card-content"><div class="menu"><h3 class="menu-label">Tags</h3><div class="field is-grouped is-grouped-multiline"><div class="control"><a class="tags has-addons" href="/tags/computer-vision/"><span class="tag">computer-vision</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/deep-learning/"><span class="tag">deep-learning</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/llm/"><span class="tag">llm</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/optimisation/"><span class="tag">optimisation</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/self-supervised-learning/"><span class="tag">self-supervised-learning</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/signal-processing/"><span class="tag">signal-processing</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/tensorflow/"><span class="tag">tensorflow</span><span class="tag">1</span></a></div></div></div></div></div><div class="column-right-shadow is-hidden-widescreen"></div></div><div class="column column-right is-4-tablet is-4-desktop is-3-widescreen is-hidden-touch is-hidden-desktop-only order-3"><div class="card widget" data-type="tags"><div class="card-content"><div class="menu"><h3 class="menu-label">Tags</h3><div class="field is-grouped is-grouped-multiline"><div class="control"><a class="tags has-addons" href="/tags/computer-vision/"><span class="tag">computer-vision</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/deep-learning/"><span class="tag">deep-learning</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/llm/"><span class="tag">llm</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/optimisation/"><span class="tag">optimisation</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/self-supervised-learning/"><span class="tag">self-supervised-learning</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/signal-processing/"><span class="tag">signal-processing</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/tensorflow/"><span class="tag">tensorflow</span><span class="tag">1</span></a></div></div></div></div></div></div></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="/img/logo.svg" alt="Ferg Blog" height="28"></a><p class="is-size-7"><span>&copy; 2023 Fergus Currie</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a></p><p class="is-size-7">© 2019</p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/ppoffice/hexo-theme-icarus"><i class="fab fa-github"></i></a></p></div></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script>moment.locale("en");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="/js/column.js"></script><script src="/js/animation.js"></script><a id="back-to-top" title="Back to top" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><!--!--><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.js" defer></script><script>window.addEventListener("load", () => {
      window.cookieconsent.initialise({
        type: "info",
        theme: "edgeless",
        static: false,
        position: "bottom-left",
        content: {
          message: "This website uses cookies to improve your experience.",
          dismiss: "Got it!",
          allow: "Allow cookies",
          deny: "Decline",
          link: "Learn more",
          policy: "Cookie Policy",
          href: "https://www.cookiesandyou.com/",
        },
        palette: {
          popup: {
            background: "#edeff5",
            text: "#838391"
          },
          button: {
            background: "#4b81e8"
          },
        },
      });
    });</script><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><script type="text/x-mathjax-config">MathJax.Hub.Config({
            'HTML-CSS': {
                matchFontHeight: false
            },
            SVG: {
                matchFontHeight: false
            },
            CommonHTML: {
                matchFontHeight: false
            },
            tex2jax: {
                inlineMath: [
                    ['$','$'],
                    ['\\(','\\)']
                ]
            }
        });</script><script src="https://cdn.jsdelivr.net/npm/mathjax@2.7.9/unpacked/MathJax.js?config=TeX-MML-AM_CHTML" defer></script><!--!--><!--!--><!--!--><script src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="Type something..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"Type something...","untitled":"(Untitled)","posts":"Posts","pages":"Pages","categories":"Categories","tags":"Tags"});
        });</script></body></html>