<!doctype html>
<html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>Ferg Blog</title><link rel="manifest" href="/manifest.json"><meta name="theme-color" content="green"><meta name="application-name" content="Ferg Blog"><meta name="msapplication-TileImage" content="/img/favicon.svg"><meta name="msapplication-TileColor" content="green"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="Ferg Blog"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta property="og:type" content="blog"><meta property="og:title" content="Ferg Blog"><meta property="og:url" content="https://ferguscurrie.github.io/"><meta property="og:site_name" content="Ferg Blog"><meta property="og:locale" content="en_US"><meta property="og:image" content="https://ferguscurrie.github.io/img/og_image.png"><meta property="article:author" content="Fergus Currie"><meta property="twitter:card" content="summary"><meta property="twitter:image:src" content="https://ferguscurrie.github.io/img/og_image.png"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://ferguscurrie.github.io"},"headline":"Ferg Blog","image":["https://ferguscurrie.github.io/img/og_image.png"],"author":{"@type":"Person","name":"Fergus Currie"},"publisher":{"@type":"Organization","name":"Ferg Blog","logo":{"@type":"ImageObject","url":"https://ferguscurrie.github.io/img/logo.svg"}},"description":""}</script><link rel="icon" href="/img/favicon.svg"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v6.0.0/css/all.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-light.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><!--!--><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/css/justifiedGallery.min.css"><!--!--><!--!--><!--!--><style>.pace{-webkit-pointer-events:none;pointer-events:none;-webkit-user-select:none;-moz-user-select:none;user-select:none}.pace-inactive{display:none}.pace .pace-progress{background:#3273dc;position:fixed;z-index:2000;top:0;right:100%;width:100%;height:2px}</style><script src="https://cdn.jsdelivr.net/npm/pace-js@1.2.4/pace.min.js"></script><!--!--><!--!--><!-- hexo injector head_end start --><script>
  (function () {
      function switchTab() {
          if (!location.hash) {
            return;
          }

          const id = '#' + CSS.escape(location.hash.substring(1));
          const $tabMenu = document.querySelector(`.tabs a[href="${id}"]`);
          if (!$tabMenu) {
            return;
          }

          const $tabMenuContainer = $tabMenu.parentElement.parentElement;
          Array.from($tabMenuContainer.children).forEach($menu => $menu.classList.remove('is-active'));
          Array.from($tabMenuContainer.querySelectorAll('a'))
              .map($menu => document.getElementById($menu.getAttribute("href").substring(1)))
              .forEach($content => $content.classList.add('is-hidden'));

          if ($tabMenu) {
              $tabMenu.parentElement.classList.add('is-active');
          }
          const $activeTab = document.querySelector(id);
          if ($activeTab) {
              $activeTab.classList.remove('is-hidden');
          }
      }
      switchTab();
      window.addEventListener('hashchange', switchTab, false);
  })();
  </script><!-- hexo injector head_end end --><meta name="generator" content="Hexo 6.3.0"></head><body class="is-3-column"><nav class="navbar navbar-main"><div class="container navbar-container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="/img/logo.svg" alt="Ferg Blog" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item is-active" href="/">Home</a><a class="navbar-item" href="/About">About</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/FergusCurrie"><i class="fab fa-github"></i></a><a class="navbar-item" target="_blank" rel="noopener" title="Linkedin" href="https://www.linkedin.com/in/fergus-currie-167233193/"><i class="fab fa-linkedin"></i></a><a class="navbar-item search" title="Search" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-6-widescreen"><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2023-06-02T04:02:21.000Z" title="2/06/2023, 4:02:21 pm">2023-06-02</time></span><span class="level-item">Updated&nbsp;<time dateTime="2023-06-13T04:51:05.071Z" title="13/06/2023, 4:51:05 pm">2023-06-13</time></span><span class="level-item">a minute read (About 114 words)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2023/06/02/llm_tricks/">LLM Tricks</a></p><div class="content"><h1 id="LLM-Training-Tricks"><a href="#LLM-Training-Tricks" class="headerlink" title="LLM Training Tricks"></a>LLM Training Tricks</h1><p>Majority of LLM are decoder only with a few tricks for:</p>
<ul>
<li>Data Tricks</li>
<li>Architechture Tricks</li>
<li>Optimisation tricks</li>
<li>Engineering tricks</li>
</ul>
<h2 id="Architechture-Tricks"><a href="#Architechture-Tricks" class="headerlink" title="Architechture Tricks"></a>Architechture Tricks</h2><ul>
<li>LayerNorm after embedding layer</li>
<li>ALiBI posiition embedding</li>
<li>RoPe position embedding</li>
<li>Lazy softmax [ref: self-attention does not need O(n^2 memory)]</li>
<li>efficient causal multihead attention (calculate (1&#x2F;2)n^2 dot products)</li>
<li>prenorm</li>
<li>residual connections</li>
<li>swiGLU</li>
</ul>
<h2 id="Optimisation-Tricks"><a href="#Optimisation-Tricks" class="headerlink" title="Optimisation Tricks"></a>Optimisation Tricks</h2><ul>
<li>AdamW</li>
<li>Cosine schedule</li>
<li>weight decay</li>
<li>gradient clipping</li>
<li>dropout</li>
<li>optmising backprop to tradeoff between memory and speed. (save more than normal for expensive operations like Wx)</li>
<li></li>
</ul>
<h2 id="Engineering-tricks"><a href="#Engineering-tricks" class="headerlink" title="Engineering tricks"></a>Engineering tricks</h2><h3 id="Mixed-precision-training"><a href="#Mixed-precision-training" class="headerlink" title="Mixed precision training"></a>Mixed precision training</h3><p>Use low precision where possible.<br>fp32, great for accuracy, demanding memory. good for softmax<br>fp16, less accurate, fast less accurate<br>bfp16</p>
<h3 id="Efficinet-cuda-‘stuff’"><a href="#Efficinet-cuda-‘stuff’" class="headerlink" title="Efficinet cuda ‘stuff’"></a>Efficinet cuda ‘stuff’</h3><p>FlashAttention</p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2023-05-14T23:00:00.000Z" title="15/05/2023, 11:00:00 am">2023-05-15</time></span><span class="level-item">Updated&nbsp;<time dateTime="2023-06-13T04:37:30.376Z" title="13/06/2023, 4:37:30 pm">2023-06-13</time></span><span class="level-item">9 minutes read (About 1313 words)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2023/05/15/fourier_transform/">Fourier Transform</a></p><div class="content"><h1 id="Fourier-Transform"><a href="#Fourier-Transform" class="headerlink" title="Fourier Transform"></a>Fourier Transform</h1><p>todo:</p>
<ul>
<li>nquist frequency - redundecny in dftr</li>
<li>fourier series</li>
<li>fourier transform</li>
<li>fourier coefficient (complex val with mag and phase) &#x3D; values for a speicifc frequency</li>
<li>wavelets</li>
<li>dft n2</li>
<li>fft nlogn (metaphorof nlogn)</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> cvxpy</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> librosa</span><br></pre></td></tr></table></figure>

<p>Begin by loading the wave form and plotting</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">audio_path = <span class="string">&quot;speech.wav&quot;</span></span><br><span class="line">waveform, sample_rate = librosa.load(audio_path, sr=<span class="literal">None</span>)  <span class="comment"># sr=None preserves sample rate</span></span><br><span class="line"></span><br><span class="line">plt.figure(figsize=(<span class="number">14</span>, <span class="number">5</span>))</span><br><span class="line">plt.plot(waveform)</span><br><span class="line">plt.title(<span class="string">f&quot;Waveform. sample rate=<span class="subst">&#123;sample_rate&#125;</span>Hz&quot;</span>)</span><br><span class="line">plt.xlabel(<span class="string">&quot;Samples&quot;</span>)</span><br><span class="line">plt.ylabel(<span class="string">&quot;Amplitude&quot;</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>

<p><img src="/images/output_3_0.png" alt="png"></p>
<p>Now lets look at what’s going on zoomed in</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">s</span>(<span class="params">t</span>):</span><br><span class="line">    <span class="keyword">return</span> waveform[<span class="number">1000</span>:<span class="number">2000</span>][t]</span><br><span class="line"></span><br><span class="line">t = np.arange(<span class="number">1000</span>)</span><br><span class="line">plt.figure(figsize=(<span class="number">14</span>, <span class="number">5</span>))</span><br><span class="line">plt.plot(s(t))</span><br><span class="line">plt.title(<span class="string">f&quot;Waveform. sample rate=<span class="subst">&#123;sample_rate&#125;</span>Hz&quot;</span>)</span><br><span class="line">plt.xlabel(<span class="string">&quot;Samples&quot;</span>)</span><br><span class="line">plt.ylabel(<span class="string">&quot;Amplitude&quot;</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>

<p><img src="/images/output_5_0.png" alt="png"></p>
<p>Okay now a brief review of sinusoids</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sinusoid</span>(<span class="params">t,freq,phase</span>):</span><br><span class="line">    <span class="keyword">return</span> np.sin(<span class="number">2</span> * np.pi * (freq * t - phase))</span><br><span class="line"></span><br><span class="line">t = np.linspace(<span class="number">0</span>,<span class="number">10</span>,<span class="number">1000</span>)</span><br><span class="line"></span><br><span class="line">plt.figure(figsize=(<span class="number">14</span>, <span class="number">5</span>))</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>):</span><br><span class="line">    y = sinusoid(t, <span class="number">1</span>, i*<span class="number">0.1</span>)</span><br><span class="line">    plt.plot(t, y, label=<span class="string">f&#x27;phase=<span class="subst">&#123;i*<span class="number">0.1</span>&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line">plt.title(<span class="string">f&quot;Sinusoid phase example&quot;</span>)</span><br><span class="line">plt.xlabel(<span class="string">&quot;Samples&quot;</span>)</span><br><span class="line">plt.ylabel(<span class="string">&quot;Amplitude&quot;</span>)</span><br><span class="line">plt.legend()</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>

<p><img src="/images/output_7_0.png" alt="png"></p>
<p>The phase is a horizontal shift of the sin wave.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sinusoid</span>(<span class="params">t,freq,phase</span>):</span><br><span class="line">    <span class="keyword">return</span> np.sin(<span class="number">2</span> * np.pi * (freq * t - phase))</span><br><span class="line"></span><br><span class="line">t = np.linspace(<span class="number">0</span>,<span class="number">10</span>,<span class="number">1000</span>)</span><br><span class="line"></span><br><span class="line">plt.figure(figsize=(<span class="number">14</span>, <span class="number">5</span>))</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">4</span>):</span><br><span class="line">    y = sinusoid(t, <span class="number">0.5</span>*i, <span class="number">1</span>)</span><br><span class="line">    plt.plot(t, y, label=<span class="string">f&#x27;freq=<span class="subst">&#123;i*<span class="number">0.5</span>&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line">plt.title(<span class="string">f&quot;Sinusoid frequency example&quot;</span>)</span><br><span class="line">plt.xlabel(<span class="string">&quot;Samples&quot;</span>)</span><br><span class="line">plt.ylabel(<span class="string">&quot;Amplitude&quot;</span>)</span><br><span class="line">plt.legend()</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>

<p><img src="/images/output_9_0.png" alt="png"></p>
<p>The fourier transform converts from the time domain to the frequency domain. It does this by representing the signal as infinitely many sinusoids of varying frequency. The main steps are:</p>
<ol>
<li>Enumerate accross frequency</li>
<li>For each frequency optimise phase to maximise similarity of sinusoid with signal</li>
<li>Calculate magnitude as similarity.</li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">freq = <span class="number">0.013</span></span><br><span class="line">phase = <span class="number">1</span></span><br><span class="line"></span><br><span class="line">plt.figure(figsize=(<span class="number">14</span>, <span class="number">5</span>))</span><br><span class="line">t = np.arange(<span class="number">1000</span>)</span><br><span class="line">y = sinusoid(t, freq, phase) * <span class="number">.1</span></span><br><span class="line">plt.plot(s(t), label=<span class="string">&#x27;origianl signal&#x27;</span>)</span><br><span class="line">plt.plot(t, y, label=<span class="string">f&#x27;sinusoid&#x27;</span>)</span><br><span class="line">plt.title(<span class="string">f&quot;Maximising similarity for freq=<span class="subst">&#123;freq&#125;</span> sinusoid by shifting phase=<span class="subst">&#123;phase&#125;</span>&quot;</span>)</span><br><span class="line">plt.xlabel(<span class="string">&quot;Samples&quot;</span>)</span><br><span class="line">plt.ylabel(<span class="string">&quot;Amplitude&quot;</span>)</span><br><span class="line">plt.legend()</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>

<p><img src="/images/output_11_0.png" alt="png"></p>
<p>They’re completly out of phase here. But we can tweak the phase to try have peaks matching.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">freq = <span class="number">0.013</span></span><br><span class="line">phase = <span class="number">0.5</span></span><br><span class="line"></span><br><span class="line">plt.figure(figsize=(<span class="number">14</span>, <span class="number">5</span>))</span><br><span class="line">t = np.arange(<span class="number">1000</span>)</span><br><span class="line">y = sinusoid(t, freq, phase) * <span class="number">.1</span></span><br><span class="line">plt.plot(s(t), label=<span class="string">&#x27;origianl signal&#x27;</span>)</span><br><span class="line">plt.plot(t, y, label=<span class="string">f&#x27;sinusoid&#x27;</span>)</span><br><span class="line">plt.title(<span class="string">f&quot;Maximising similarity for freq=<span class="subst">&#123;freq&#125;</span> sinusoid by shifting phase=<span class="subst">&#123;phase&#125;</span>&quot;</span>)</span><br><span class="line">plt.xlabel(<span class="string">&quot;Samples&quot;</span>)</span><br><span class="line">plt.ylabel(<span class="string">&quot;Amplitude&quot;</span>)</span><br><span class="line">plt.legend()</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>

<p><img src="/images/output_13_0.png" alt="png"></p>
<p>That’s a bit better. To measure the similarity between the signal and the sinusoid specified by frequency and phase we use an inner product.</p>
<p>$$ \phi<em>f &#x3D; argmax</em>{\phi \in [0,1]} \left[ \int s(t) \sin(2 \pi (ft - \phi)) dt\right] $$</p>
<p>So the similarity is the area of the product of the original signal and the sinusoid. Intuitievly if they’re out of phase they cancel each other and the area is minimised.</p>
<p>The magnitude (similarity) is then:<br>$$ \phi<em>f &#x3D; max</em>{\phi \in [0,1]} \left[ \int s(t) \sin(2 \pi (ft - \phi)) dt \right] $$</p>
<p>Looking at the out of phase product:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">freq = <span class="number">0.013</span></span><br><span class="line">phase = <span class="number">1</span></span><br><span class="line"></span><br><span class="line">plt.figure(figsize=(<span class="number">14</span>, <span class="number">5</span>))</span><br><span class="line">t = np.arange(<span class="number">1000</span>)</span><br><span class="line">y = sinusoid(t, freq, phase) * <span class="number">.1</span></span><br><span class="line">plt.plot(t, s(t) * y, label=<span class="string">f&#x27;product&#x27;</span>)</span><br><span class="line">plt.plot(np.zeros(<span class="number">1000</span>))</span><br><span class="line">plt.title(<span class="string">f&quot;Out of phase Product between signal and sinusoid for freq=<span class="subst">&#123;freq&#125;</span>  by shifting phase=<span class="subst">&#123;phase&#125;</span>&quot;</span>)</span><br><span class="line">plt.xlabel(<span class="string">&quot;Samples&quot;</span>)</span><br><span class="line">plt.ylabel(<span class="string">&quot;Amplitude&quot;</span>)</span><br><span class="line">plt.legend()</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>

<p><img src="/images/output_16_0.png" alt="png"></p>
<p>Notice it’s mostly negative</p>
<p>And now looking at the inphase product:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">freq = <span class="number">0.013</span></span><br><span class="line">phase = <span class="number">0.5</span></span><br><span class="line"></span><br><span class="line">plt.figure(figsize=(<span class="number">14</span>, <span class="number">5</span>))</span><br><span class="line">t = np.arange(<span class="number">1000</span>)</span><br><span class="line">y = sinusoid(t, freq, phase) * <span class="number">.1</span></span><br><span class="line">plt.plot(t, s(t) * y, label=<span class="string">f&#x27;product&#x27;</span>)</span><br><span class="line">plt.plot(np.zeros(<span class="number">1000</span>))</span><br><span class="line">plt.title(<span class="string">f&quot;Product between signal and sinusoid for freq=<span class="subst">&#123;freq&#125;</span>  by shifting phase=<span class="subst">&#123;phase&#125;</span>&quot;</span>)</span><br><span class="line">plt.xlabel(<span class="string">&quot;Samples&quot;</span>)</span><br><span class="line">plt.ylabel(<span class="string">&quot;Amplitude&quot;</span>)</span><br><span class="line">plt.legend()</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>

<p><img src="/images/output_18_0.png" alt="png"></p>
<p>Mostly positive. This in-phase product will have a much higher area, which will be calculated with the integral.</p>
<p>So a simple fourier transform would iterative over a bunch of frequencies, for each find phase that maximises inner product with signal, and record the magnitude (area&#x2F;similarity). Will do that now:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">num_phases = <span class="number">10</span></span><br><span class="line">num_freqs = <span class="number">1000</span></span><br><span class="line"></span><br><span class="line">freq_max_magnitudes = np.zeros(num_freqs)</span><br><span class="line"><span class="keyword">for</span> freq_i, freq <span class="keyword">in</span> <span class="built_in">enumerate</span>(np.linspace(<span class="number">0</span>, <span class="number">0.1</span>, num_freqs)):</span><br><span class="line">    phase_magnitudes = np.zeros(num_phases)</span><br><span class="line">    <span class="keyword">for</span> phase_i, phase <span class="keyword">in</span> <span class="built_in">enumerate</span>(np.linspace(<span class="number">0</span>, <span class="number">1</span>, num_phases)):</span><br><span class="line">        magnitude = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> t <span class="keyword">in</span> np.arange(<span class="number">1000</span>):</span><br><span class="line">            prod = s(t) * np.sin(np.pi * <span class="number">2</span> * (freq * t - phase))</span><br><span class="line">            magnitude += prod</span><br><span class="line">        phase_magnitudes[phase_i] = magnitude</span><br><span class="line">    freq_max_magnitudes[freq_i] = np.<span class="built_in">max</span>(phase_magnitudes)</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">plt.figure(figsize=(<span class="number">14</span>, <span class="number">5</span>))</span><br><span class="line">f = np.linspace(<span class="number">0</span>, <span class="number">0.1</span>, num_freqs)</span><br><span class="line">plt.plot(f, freq_max_magnitudes)</span><br><span class="line">plt.title(<span class="string">f&quot;Spectrograph&quot;</span>)</span><br><span class="line">plt.xlabel(<span class="string">&quot;Frequency&quot;</span>)</span><br><span class="line">plt.ylabel(<span class="string">&quot;Magnitude&quot;</span>)</span><br><span class="line">plt.legend()</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>

<p><img src="/images/output_22_1.png" alt="png"></p>
<p>This concludes the first section on the basics of the fourier transform. I will now move on to representing this in a cleaner way, using complex numbers.</p>
<h1 id="Complex-Number-Fourier-Transform"><a href="#Complex-Number-Fourier-Transform" class="headerlink" title="Complex Number Fourier Transform"></a>Complex Number Fourier Transform</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"><span class="keyword">import</span> imageio</span><br><span class="line"><span class="keyword">from</span> IPython.display <span class="keyword">import</span> Image, display</span><br><span class="line"></span><br><span class="line"><span class="comment"># Generate your matplotlib plots</span></span><br><span class="line"><span class="comment"># Replace the code below with your own plot generation logic</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>First a remineder on complex numbers .</p>
<p>$ i &#x3D; \sqrt{ -1 }$</p>
<p>Usually expressed with real and complext part</p>
<p>z &#x3D; 3 + 2j</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Complex number</span></span><br><span class="line">z = <span class="number">0</span> + <span class="number">2j</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Extract real and imaginary parts</span></span><br><span class="line">x = z.real</span><br><span class="line">y = z.imag</span><br><span class="line"></span><br><span class="line"><span class="comment"># Create a scatter plot</span></span><br><span class="line">plt.scatter(x, y, color=<span class="string">&#x27;red&#x27;</span>)</span><br><span class="line">plt.xlabel(<span class="string">&#x27;Real&#x27;</span>)</span><br><span class="line">plt.ylabel(<span class="string">&#x27;Imaginary&#x27;</span>)</span><br><span class="line">plt.title(<span class="string">&#x27;Complex Number&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Show the plot</span></span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>

<p><img src="/images/output_27_0.png" alt="png"></p>
<p>This is graphed on the imaginary&#x2F;real plane. Next lets look at the euler formula</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">theta = np.linspace(<span class="number">0</span>, <span class="number">2</span>*np.pi, <span class="number">50</span>)</span><br><span class="line">euler_form = np.exp(z * theta)</span><br><span class="line"></span><br><span class="line">x = euler_form.real</span><br><span class="line">y = euler_form.imag</span><br><span class="line"></span><br><span class="line"><span class="comment"># Create a scatter plot</span></span><br><span class="line">plt.scatter(x, y, color=<span class="string">&#x27;red&#x27;</span>)</span><br><span class="line">plt.xlabel(<span class="string">&#x27;Real&#x27;</span>)</span><br><span class="line">plt.ylabel(<span class="string">&#x27;Imaginary&#x27;</span>)</span><br><span class="line">plt.title(<span class="string">&#x27;Complex Number&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p><img src="/images/output_29_1.png" alt="png"></p>
<p>We can see it traces the unit sphere. It might be helpful to look at a GIF of this in action</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line">num_frames = <span class="number">40</span></span><br><span class="line">frames = []</span><br><span class="line"><span class="keyword">if</span> os.path.exists(<span class="string">&#x27;frames&#x27;</span>):</span><br><span class="line">    os.system(<span class="string">&#x27;rm -rf frames&#x27;</span>)</span><br><span class="line">os.mkdir(<span class="string">&#x27;frames&#x27;</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(num_frames):</span><br><span class="line">    theta_ = theta[:i]</span><br><span class="line">    euler_form = np.exp(z * theta_)</span><br><span class="line"></span><br><span class="line">    x = euler_form.real</span><br><span class="line">    y = euler_form.imag</span><br><span class="line"></span><br><span class="line">    plt.plot(x, y)</span><br><span class="line">    plt.title(<span class="string">f&quot;Frame <span class="subst">&#123;i+<span class="number">1</span>&#125;</span>&quot;</span>)</span><br><span class="line">    plt.xlabel(<span class="string">&quot;Real&quot;</span>)</span><br><span class="line">    plt.ylabel(<span class="string">&quot;Imaginary&quot;</span>)</span><br><span class="line">    plt.xlim(-<span class="number">1.1</span>, <span class="number">1.1</span>)</span><br><span class="line">    plt.ylim(-<span class="number">1.1</span>, <span class="number">1.1</span>)</span><br><span class="line">    plt.gca().set_aspect(<span class="string">&#x27;equal&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Save the current plot as an image</span></span><br><span class="line">    plt.savefig(<span class="string">f&quot;frames/frame_<span class="subst">&#123;i&#125;</span>.png&quot;</span>)</span><br><span class="line">    plt.close()  <span class="comment"># Close the figure to avoid memory leaks</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># Read the saved image and append it to the frames list</span></span><br><span class="line">    frames.append(imageio.imread(<span class="string">f&quot;frames/frame_<span class="subst">&#123;i&#125;</span>.png&quot;</span>))</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> os.path.exists(<span class="string">&#x27;frames&#x27;</span>):</span><br><span class="line">    os.system(<span class="string">&#x27;rm -rf frames&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Save the frames as a GIF</span></span><br><span class="line">imageio.mimsave(<span class="string">&quot;euler.gif&quot;</span>, frames, duration=<span class="number">0.1</span>)</span><br></pre></td></tr></table></figure>

<p><img src="/images/euler.gif"></p>
<p>This shows how the euler formula traces the unit sphere on the complex plane counter clockwise. This gives an easy way of representing the polar coordinates of a complex number c:</p>
<p>$$ c &#x3D; |c|\exp{(i \theta)} $$</p>
<p>where $\exp{(i \theta)}$ gives a direction and the absolute length of c gives the distance to the complex number c.</p>
<p>The point of all this complex stuff is to use the magnitude and phase as polar coordinates. Phase gives the roation while magnitude gives the distance.</p>
<p>We can then write the fourier coefficient as :</p>
<p>$$ c_f &#x3D; \dfrac{d_f}{\sqrt 2 } \exp(-i2 \pi\theta f)$$</p>
<p>The minus sign in the exponent switches to tracking clockwise.</p>
<p>The fourier transform can then be expressed….</p>
<h1 id="Inverse-Fourier-Transform"><a href="#Inverse-Fourier-Transform" class="headerlink" title="Inverse Fourier Transform"></a>Inverse Fourier Transform</h1><p>…</p>
<h1 id="Discrete-Fourier-Transform"><a href="#Discrete-Fourier-Transform" class="headerlink" title="Discrete Fourier Transform"></a>Discrete Fourier Transform</h1><p>…</p>
<h1 id="Fast-Fourier-Transform"><a href="#Fast-Fourier-Transform" class="headerlink" title="Fast Fourier Transform"></a>Fast Fourier Transform</h1><p>…</p>
<h1 id="Short-Time-Fourier-Transform"><a href="#Short-Time-Fourier-Transform" class="headerlink" title="Short Time Fourier Transform"></a>Short Time Fourier Transform</h1><p>…</p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2023-05-02T02:02:21.000Z" title="2/05/2023, 2:02:21 pm">2023-05-02</time></span><span class="level-item">Updated&nbsp;<time dateTime="2023-06-13T04:50:52.743Z" title="13/06/2023, 4:50:52 pm">2023-06-13</time></span><span class="level-item">3 minutes read (About 436 words)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2023/05/02/deep_cluster/">Deep Cluster</a></p><div class="content"><h1 id="Deep-Cluster"><a href="#Deep-Cluster" class="headerlink" title="Deep Cluster"></a>Deep Cluster</h1><h2 id="Intro"><a href="#Intro" class="headerlink" title="Intro"></a>Intro</h2><p>Due to the difficult around obtaining good labelled data, self-supervised learning has been increasing in popularity over the last five year. Yann LeCun is a major proponente and his team at Meta AI are constantly publishing papers on the topic.</p>
<p>Their recent “Cook Book of Self-Supervised Learning” [arXiv:2304.12210] divides the field into three approaches: self-distillation, constrastive and canonical correlation analysis. Of the three I think that self-distillation is the most surprising and challenges some fundemental intuitions about what works when training these models. They are based on the experimental observation that a linear classifier trainined on the features extracted from a random initalised AlexNet encoder obtains 14% top-1 accuracy on ImageNet, where random guessing is 0.1%. In this blog post I look at one of the early approaches to self-distillation - ‘Deep Cluster’.</p>
<h2 id="DeepCluster"><a href="#DeepCluster" class="headerlink" title="DeepCluster"></a>DeepCluster</h2><p>Self-distillation models use their own output to generate labels which the model will be retrained on, then the process repeats. Deep Cluster uses an AlexNet encoder as a feature extractor, and applies kmeans to the extracted features to obtain labels.</p>
<p>Collapse is a key issue in self-supervised learning. Collapse occurs when the network learns a trival representation to solve the learning task. For example Deep Cluster could collapse by the network learning to output a single embeddding, regardless of input. This would result in each instance being grouped into the same cluster, and then the network can achieve perfect accuracy by predicting that cluster. However a constant embedding isn’t very useful, so the authors have found two mechanisms to prevent collapse.</p>
<p>The first mechanism to prevent collapse is to encourage equiparition. Equipartion means that the same number of isntances are grouped into each cluster. To implement this; any cluster that has no instances in it will update it’s centroid to a random other centroid with a small peturbation. This causes it to take about half the other clusters instances.</p>
<p>The second mechanism to prevent collapse is to weight the loss contribution of an instance inversely to the size of the cluster. This means large clusters will have less importance per instance, whereas small clusters will have more important instances.</p>
<h2 id="Implementation-notes"><a href="#Implementation-notes" class="headerlink" title="Implementation notes"></a>Implementation notes</h2><p>I use the FAISS implementation of PCA and kmeans. PCA is applied to the embeddings to reduce them from 9216 to 256. This makes the code more memory efficient.</p>
<p>The paper uses whitening but this is too expensive for me to use. I substract the mean, divide by the variance and divide by the L2 norm.</p>
<p>Clustering is really slow, it requires a full pass on the dataset.</p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2023-04-02T04:02:21.000Z" title="2/04/2023, 4:02:21 pm">2023-04-02</time></span><span class="level-item">Updated&nbsp;<time dateTime="2023-06-13T04:36:05.067Z" title="13/06/2023, 4:36:05 pm">2023-06-13</time></span><span class="level-item">3 minutes read (About 418 words)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2023/04/02/cuttingplane/">Cutting Plane Algorithms</a></p><div class="content"><h1 id="Cutting-plane-methods"><a href="#Cutting-plane-methods" class="headerlink" title="Cutting-plane methods."></a>Cutting-plane methods.</h1><p>Cutting plane methods are a useful tool for solving optimization problems. In particular they solve non-differentiable convex problems. The general problem they solve is finding any point in a set $X \in \mathbb{R}^n $.<br>The cutting-plane method is essentially a generilisatoin of bisectoin in $\mathbb{R}$.</p>
<p>The simplest example is the following:</p>
<ol>
<li>Constraints &#x3D; $P_k &#x3D;{}$</li>
<li>Pick a point $x^{(k)} \in \mathbb{R}^n, x^{(k)} \in P_k$</li>
<li>If $x^{(k)} \in X$ then stop.</li>
<li>Calculate a subgradient $g$ at $x$</li>
<li>Add the inequality $g^{(k)T} z \leq x^{(k)})$ to the set of constraints.</li>
<li>goto 2.</li>
</ol>
<p>‘Exentsion’ impolies there’s a base method. BUt there’s no base method. These are just method of choosing the next point. Possible i would consider the ellipsoid method an extension.<br>Four extensions of this method are:</p>
<ul>
<li>Center of gravity cutting-plane method</li>
<li>Chebyshev center cutting-plane method</li>
<li>Maximum volume ellpsoid method</li>
<li>Analytic Cutting plane Method</li>
<li>Ellipsoid method</li>
</ul>
<p>The extensions all seek to find a better point $x^{(k)}$ than a random selection. We basically want the cutting plane to reduce the search space as much as possible. Therefore the center of the polyhedron is a good choice.</p>
<h2 id="Center-of-Gravity-Cutting-plane-Method"><a href="#Center-of-Gravity-Cutting-plane-Method" class="headerlink" title="Center of Gravity Cutting-plane Method"></a>Center of Gravity Cutting-plane Method</h2><p>This algorithm is so ineffient that it’s considered a theoretical approach. It does highlight exactly what these extensions are trying to do.</p>
<p>It picks the next search point as the center of gravity of the polyhedron.</p>
<p>$$</p>
<p>x ^ {(k+1)} &#x3D; \dfrac{\int_{P_k}xdx}{\int_{P_k}dx}</p>
<p>$$</p>
<h2 id="Chebyshev-Center-Cutting-plane-Method"><a href="#Chebyshev-Center-Cutting-plane-Method" class="headerlink" title="Chebyshev Center Cutting-plane Method"></a>Chebyshev Center Cutting-plane Method</h2><p>This method picks the next search point as the center of the largest ball that fits inside the polyhedron. This can be founded via an LP. It a common problem called Chebshev centeing.</p>
<p>$$<br>\begin{aligned}<br>\max \quad &amp; R  \<br>\textrm{s.t.} \quad &amp; a_i^T x + R ||a_i||_* \leq b_i, i &#x3D; 1,…,m \<br>\quad &amp; R \geq 0 \<br>\end{aligned}<br>$$</p>
<h2 id="Maximum-volume-ellipsoid-method"><a href="#Maximum-volume-ellipsoid-method" class="headerlink" title="Maximum volume ellipsoid method"></a>Maximum volume ellipsoid method</h2><p>This is similar to the chebyshev method in that it finds the largest ellipsoid which fits in the polyhedra and then takes the center point of that</p>
<h2 id="Analytic-Cutting-Plane-Method"><a href="#Analytic-Cutting-Plane-Method" class="headerlink" title="Analytic Cutting Plane Method"></a>Analytic Cutting Plane Method</h2><p>The basic idea here is to find the ‘analytic center’ of the polyhedron. This optimises a log barrier funciton which can be computed using the infeasible start newton method.</p>
<h2 id="Ellipsoid-Method"><a href="#Ellipsoid-Method" class="headerlink" title="Ellipsoid Method"></a>Ellipsoid Method</h2><h2 id="Intersting-subproblems"><a href="#Intersting-subproblems" class="headerlink" title="Intersting subproblems:"></a>Intersting subproblems:</h2><ul>
<li>Volume of an ellipsoid</li>
<li>Minimum cover ellipsoid of polyhedron</li>
<li>Center of gravity</li>
<li>Maximum volume ellipsoid inside polyhedron</li>
<li>Largest ball in polyhedra</li>
</ul>
<h1 id="Questions"><a href="#Questions" class="headerlink" title="Questions?"></a>Questions?</h1><p>Center of ellipsoid? Well center of ball is</p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2023-03-29T03:02:21.000Z" title="29/03/2023, 4:02:21 pm">2023-03-29</time></span><span class="level-item">Updated&nbsp;<time dateTime="2023-06-13T04:50:40.823Z" title="13/06/2023, 4:50:40 pm">2023-06-13</time></span><span class="level-item">5 minutes read (About 724 words)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2023/03/29/advanced_tf/">Coursera - TensorFlow Advanced Techniques Specialisation</a></p><div class="content"><p>I just finished DeepLearning.AI’s advanced TensorFlow course through coursera. The specialisatoin is divided into four courses;</p>
<ul>
<li>Custom Models, Layers and Loss Functions with TensorFlow</li>
<li>Custom and Distributed Training with TensorFlow</li>
<li>Advanced Computer Vision with TensorFlow</li>
<li>Generative Deep Learning with TensorFlow</li>
</ul>
<p>I’ll go into more detail on each course below, give a few critiques, but I’ll start with a brief overview of my experience with the course.</p>
<p>Overall I enjoyed the course but found the second half a bit underwhelming. It brushed me up on some of the finer points of my core knowledge of TensorFlow, but didn’t really teach me anything new. I think the course isn’t as focsued as it should be, it feels like a mixutre of an introudciton to TensorFlow beyond the sequential API and an introductory deep learning course.</p>
<p>The course can be found here: <a target="_blank" rel="noopener" href="https://www.coursera.org/specializations/tensorflow-advanced-techniques?adgroupid=121113573337&adpostion=&campaignid=13433112712&creativeid=645461735227&device=c&devicemodel=&gclid=Cj0KCQjw2cWgBhDYARIsALggUhpN9AADSzcNtADCFnJ8jfsj621bj_qUw1DdPDcZuX4z4WLQt6g4AM4aAq-WEALw_wcB&hide_mobile_promo=&keyword=coursera%20+&matchtype=b&network=g&utm_campaign=04-CourseraPlus-ESC&utm_content=B2C&utm_medium=sem&utm_source=gg">TensorFlow: Advanced Techniques Specialisation</a>.</p>
<h2 id="Custom-Models-Layers-and-Loss-Functions-with-TensorFlow"><a href="#Custom-Models-Layers-and-Loss-Functions-with-TensorFlow" class="headerlink" title="Custom Models, Layers and Loss Functions with TensorFlow"></a>Custom Models, Layers and Loss Functions with TensorFlow</h2><p>This was probably my favourite course in the specialization. It was closer to what I was looking for in terms of the inner working of TensorFlow rather than the applications. The course covered the following topics; Functional vs Sequential API, Custom losses, layers, models and callbacks.</p>
<h2 id="Custom-and-Distributed-Training-with-TensorFlow"><a href="#Custom-and-Distributed-Training-with-TensorFlow" class="headerlink" title="Custom and Distributed Training with TensorFlow"></a>Custom and Distributed Training with TensorFlow</h2><p>Most of the distributed training felt supuflous, although some familiaryt with the basic TensorFLow objects for this is useful. The course covered the following topics; Differentiation and gradients with gradient tape, custom training loops, graph mode vs eagerm ode and dsitributed training strategies.</p>
<h2 id="Advanced-Computer-Vision-with-TensorFlow"><a href="#Advanced-Computer-Vision-with-TensorFlow" class="headerlink" title="Advanced Computer Vision with TensorFlow"></a>Advanced Computer Vision with TensorFlow</h2><p>I didn’t love this course. It was a bit of a whirl-wind tour of using the techniques from course 1 and course 2 to build a few different models accross problems including segmentation, classification and object detection. It was a bit too applied for my taste, I was familiar with most of the concepts and if i’m going to spend time training models I would prefer to do it on my own projects.</p>
<h2 id="Generative-Deep-Learning-with-TensorFlow"><a href="#Generative-Deep-Learning-with-TensorFlow" class="headerlink" title="Generative Deep Learning with TensorFlow"></a>Generative Deep Learning with TensorFlow</h2><p>I actually quite enjoyed this course despite it’s similarities to course 3. It’s pretty hard not to appreciate the results of the generative techniques we covered. It was broken down into four chunks: neural style transfer, which I had read the paper for but not implemented, autoencoders, variational autoencoders and GANs.</p>
<h1 id="Critiques-of-the-Specialization"><a href="#Critiques-of-the-Specialization" class="headerlink" title="Critiques of the Specialization"></a>Critiques of the Specialization</h1><p>I have three main criques on the course which I’ll go into in more detail below. Topic choice andgamification of coursera.</p>
<p>My problem with the content, primarily in the latter courses, is that it wasn’t very specific to TensorFlow. It was more of a general introduction to deep learning and the techniques used in the field - with implementations in TensorFlow. I think for introductory courses this makes sense, trying to get the earner interested in the field and giving motivating examples. However, I think for a specialization it should be more specific to the framework, really digging into how things work. This would serve me better as a developer.</p>
<p>The primary issue i’ve faced with all coursera work is the natural gamification of the platform. The videos, quizes and assignments, quizes are all relatively bite-sized and easy to consume. This is great for getting it done quickly, but it’s not great for retaining information. I’ve found it difficult not to use just get the videos out of the way and smash out the assignment as quickly as possible. I think this is a problem with the platform, not the course. It’s too tempting to just get the work done and move on. I think a more effective approach would be to have longer videos in a more lecture style format, with more content. THe assignments should be removed and replaced with longer quizes, including random sampling of questions to prevent brute forcing, limited retries, and short answer coding questions to really test understanding.<br>This format would create much more pressure on the learner, which is bound to give better results.</p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2020-03-29T03:02:21.000Z" title="29/03/2020, 4:02:21 pm">2020-03-29</time></span><span class="level-item">Updated&nbsp;<time dateTime="2023-06-13T04:31:52.934Z" title="13/06/2023, 4:31:52 pm">2023-06-13</time></span><span class="level-item">a minute read (About 123 words)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2020/03/29/hello-world/">Hello World</a></p><div class="content"><p>Welcome to <a target="_blank" rel="noopener" href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a target="_blank" rel="noopener" href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a target="_blank" rel="noopener" href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a target="_blank" rel="noopener" href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p>
<h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">&quot;My New Post&quot;</span></span><br></pre></td></tr></table></figure>

<p>More info: <a target="_blank" rel="noopener" href="https://hexo.io/docs/writing.html">Writing</a></p>
<h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure>

<p>More info: <a target="_blank" rel="noopener" href="https://hexo.io/docs/server.html">Server</a></p>
<h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure>

<p>More info: <a target="_blank" rel="noopener" href="https://hexo.io/docs/generating.html">Generating</a></p>
<h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure>

<p>More info: <a target="_blank" rel="noopener" href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>
</div></article></div></div><div class="column column-left is-4-tablet is-4-desktop is-3-widescreen  order-1"><div class="card widget" data-type="profile"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar" src="/img/avatar.png" alt="Fergus Currie"></figure><p class="title is-size-4 is-block" style="line-height:inherit;">Fergus Currie</p><p class="is-size-6 is-block">Machine Learning Engineer</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>Melbourne</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">Posts</p><a href="/archives"><p class="title">6</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Categories</p><a href="/categories"><p class="title">0</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Tags</p><a href="/tags"><p class="title">7</p></a></div></div></nav><div class="level"><a class="level-item button is-primary is-rounded" href="https://github.com/ppoffice" target="_blank" rel="noopener">Follow</a></div><div class="level is-mobile is-multiline"><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Github" href="https://github.com/FergusCurrie"><i class="fab fa-github"></i></a></div></div></div><!--!--><!--!--><div class="card widget" data-type="recent-posts"><div class="card-content"><h3 class="menu-label">Recents</h3><article class="media"><div class="media-content"><p class="date"><time dateTime="2023-06-02T04:02:21.000Z">2023-06-02</time></p><p class="title"><a href="/2023/06/02/llm_tricks/">LLM Tricks</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2023-05-14T23:00:00.000Z">2023-05-15</time></p><p class="title"><a href="/2023/05/15/fourier_transform/">Fourier Transform</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2023-05-02T02:02:21.000Z">2023-05-02</time></p><p class="title"><a href="/2023/05/02/deep_cluster/">Deep Cluster</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2023-04-02T04:02:21.000Z">2023-04-02</time></p><p class="title"><a href="/2023/04/02/cuttingplane/">Cutting Plane Algorithms</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2023-03-29T03:02:21.000Z">2023-03-29</time></p><p class="title"><a href="/2023/03/29/advanced_tf/">Coursera - TensorFlow Advanced Techniques Specialisation</a></p></div></article></div></div><div class="card widget" data-type="archives"><div class="card-content"><div class="menu"><h3 class="menu-label">Archives</h3><ul class="menu-list"><li><a class="level is-mobile" href="/archives/2023/"><span class="level-start"><span class="level-item">2023</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile" href="/archives/2020/"><span class="level-start"><span class="level-item">2020</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></div></div></div><div class="card widget" data-type="tags"><div class="card-content"><div class="menu"><h3 class="menu-label">Tags</h3><div class="field is-grouped is-grouped-multiline"><div class="control"><a class="tags has-addons" href="/tags/computer-vision/"><span class="tag">computer-vision</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/deep-learning/"><span class="tag">deep-learning</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/llm/"><span class="tag">llm</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/optimisation/"><span class="tag">optimisation</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/self-supervised-learning/"><span class="tag">self-supervised-learning</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/signal-processing/"><span class="tag">signal-processing</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/tensorflow/"><span class="tag">tensorflow</span><span class="tag">1</span></a></div></div></div></div></div><div class="column-right-shadow is-hidden-widescreen"></div></div><div class="column column-right is-4-tablet is-4-desktop is-3-widescreen is-hidden-touch is-hidden-desktop-only order-3"><div class="card widget" data-type="tags"><div class="card-content"><div class="menu"><h3 class="menu-label">Tags</h3><div class="field is-grouped is-grouped-multiline"><div class="control"><a class="tags has-addons" href="/tags/computer-vision/"><span class="tag">computer-vision</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/deep-learning/"><span class="tag">deep-learning</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/llm/"><span class="tag">llm</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/optimisation/"><span class="tag">optimisation</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/self-supervised-learning/"><span class="tag">self-supervised-learning</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/signal-processing/"><span class="tag">signal-processing</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/tensorflow/"><span class="tag">tensorflow</span><span class="tag">1</span></a></div></div></div></div></div></div></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="/img/logo.svg" alt="Ferg Blog" height="28"></a><p class="is-size-7"><span>&copy; 2023 Fergus Currie</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a></p><p class="is-size-7">© 2019</p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/ppoffice/hexo-theme-icarus"><i class="fab fa-github"></i></a></p></div></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script>moment.locale("en");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="/js/column.js"></script><script src="/js/animation.js"></script><a id="back-to-top" title="Back to top" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><!--!--><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.js" defer></script><script>window.addEventListener("load", () => {
      window.cookieconsent.initialise({
        type: "info",
        theme: "edgeless",
        static: false,
        position: "bottom-left",
        content: {
          message: "This website uses cookies to improve your experience.",
          dismiss: "Got it!",
          allow: "Allow cookies",
          deny: "Decline",
          link: "Learn more",
          policy: "Cookie Policy",
          href: "https://www.cookiesandyou.com/",
        },
        palette: {
          popup: {
            background: "#edeff5",
            text: "#838391"
          },
          button: {
            background: "#4b81e8"
          },
        },
      });
    });</script><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><script type="text/x-mathjax-config">MathJax.Hub.Config({
            'HTML-CSS': {
                matchFontHeight: false
            },
            SVG: {
                matchFontHeight: false
            },
            CommonHTML: {
                matchFontHeight: false
            },
            tex2jax: {
                inlineMath: [
                    ['$','$'],
                    ['\\(','\\)']
                ]
            }
        });</script><script src="https://cdn.jsdelivr.net/npm/mathjax@2.7.9/unpacked/MathJax.js?config=TeX-MML-AM_CHTML" defer></script><!--!--><!--!--><!--!--><script src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="Type something..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"Type something...","untitled":"(Untitled)","posts":"Posts","pages":"Pages","categories":"Categories","tags":"Tags"});
        });</script></body></html>